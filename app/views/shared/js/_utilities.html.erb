<script>
$(document).ready( function(root){
  var ProfileLib = root.ProfileLib = (root.ProfileLib || {});

  var notify = ProfileLib.notify = function(
    message, color, destination, method, hide) {

      var $notifications = $('<div class="notifications ' + color + '">');
      $notifications.text(message);

      switch(method) {
        case "before":
          destination.before($notifications);
          break;
        case "after":
          destination.after($notifications);
          break;
        case "prepend":
          destination.prepend($notifications);
          break;
        default:
          destination.append($notifications);
          break;
      }

      if (hide) {
        ProfileLib.delayedRemove($notifications)
      }
  }

  var delayedRemove = ProfileLib.delayedRemove = function(jQueryObj) {
    timeoutID = window.setTimeout(function() {
      jQueryObj.remove();
    }, 1000);
  }

  var cleanUp = ProfileLib.cleanUp = function($field, $clicked_button,
    $other_button, $activeCurrentVal, $property) {
    $field.remove();
    $clicked_button.remove();
    $other_button.remove();
    $activeCurrentVal.removeClass("active");
    $property.removeClass("editing");
  }

  var createField = ProfileLib.createField = function(fieldType, fieldValue) {
    if (["state", "industry", "summary",
      "current_student", "awards"].indexOf(fieldType) === -1) {
        if (["start_date", "end_date", "current_student"]
          .indexOf(fieldType) === -1) {

            var inputType = "text";
          } else {
            var inputType = "date";
          }

        var html = '<input class="field" type="' + inputType + '" value="';
        html += fieldValue + '">';
    }

    else if (fieldType == "current_student") {
        var html = '<input class="field" type="checkbox"';

        if (fieldValue == "checked") {
          html += " checked"
        };

        html += ">"
    }

    else if (["summary", "awards"].indexOf(fieldType) !== -1) {
    	  var html = '<textarea class="field">';
	      html += fieldValue + '</textarea>';
    }

    else {
	      var html = '<select class="field">';

	      if (fieldType === "state") {
	        var options = ["NY", "CA"];

		      html += '<option>Select a State</option>';
	      } else {
    		  var options = [
    		        "Real Estate",
    		        "Technology",
    		        "Advertising",
    		        "Hospitality",
    		        "Health/Medicine",
    		        "Banana Stand",
    		        "Other"
    		      ];

		      html += '<option>Select an Industry</option>';
	      }

        options.forEach( function(option) {
          html += '<option value="' + option + '"';

    		  if (fieldValue == option) {
    			  html += " selected";
    		  }

          html += '>' + option + '</option>';
        });
      }

    return html;
  }

  var getDest = ProfileLib.getDest = function(type) {
    return $("#profile-" + type + " > ul");
  }

  var afterCreation = ProfileLib.afterCreation = function(event, data) {

    var $form = $(event.target);
    var type = $form.attr("id");
    var $html = data;

    $("#profile-" + type + " > .notifications").hide();

    if (type !== "status") {
      $form.hide();
    } else {
      $form[0].reset();
    }

    $("#add-" + type).show();

    ProfileLib.getDest(type).prepend($html);

    ProfileLib.notify(type + " created successfully!", "green",
      ProfileLib.getDest(type), "before", true);
  }
});
</script>
